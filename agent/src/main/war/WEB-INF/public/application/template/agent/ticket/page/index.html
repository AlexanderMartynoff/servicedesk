<h1 class="page-header">Заявки</h1>

<div class="row">

    <div class="col-sm-3">
        <form class="form-horizontal">
            <div class="form-group">
                <div class="col-sm-6">
                    <label class="control-label">Дата начала</label>
                    <div class="input-group" ng-controller="DateTicketController">
                        <input class="form-control"
                               ng-model="ticket.dateOpen"
                               uib-datepicker-popup="dd.MM.yyyy"
                               is-open="opened"
                               close-text="Закрыть"
                               clear-text="Очистить"
                               current-text="Сегодня"
                               ng-click="open($event)"/>
                        <span class="input-group-btn">
                            <button type="button" class="btn btn-default" ng-click="open($event)">
                                <i class="fa fa-calendar"></i>
                            </button>
                        </span>
                    </div>
                </div>
                <div class="col-sm-6">
                    <label class="control-label">Дата конца</label>
                    <div class="input-group" ng-controller="DateTicketController">
                        <input class="form-control"
                               ng-model="ticket.dateOpen"
                               uib-datepicker-popup="dd.MM.yyyy"
                               is-open="opened"
                               close-text="Закрыть"
                               clear-text="Очистить"
                               current-text="Сегодня"
                               ng-click="open($event)"/>
                        <span class="input-group-btn">
                            <button type="button" class="btn btn-default" ng-click="open($event)">
                                <i class="fa fa-calendar"></i>
                            </button>
                        </span>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <div class="col-sm-12">
                    <label class="control-label">Заголовок</label>
                    <input type="text"
                           ng-model="filter.title"
                           class="form-control"
                           placeholder="Поиск по заголовку">
                </div>
                <div class="col-sm-12">
                    <label class="control-label">Исполнитель</label><br/>
                    <input type="text"
                           ng-model="filter.performer"
                           class="form-control"
                           placeholder="Поиск по исполнителю">
                </div>
            </div>

            <div class="btn-group btn-group-justified">
                <a href="" class="vertical-align-btm btn btn-info form-control" ng-click="updateTicketList()">
                    <b class="fa fa-search fa-left"></b>Обновить
                </a>
                <a href="" class="vertical-align-btm btn btn-success form-control" ng-click="new()">
                    <b class="fa fa-plus-square fa-left"></b>Создать
                </a>
            </div>

        </form>
    </div>

    <div class="col-sm-9">
        <div class="row">
            <div class="col-xs-12">
                <div ng-if="paginator.$$collection.length === 0" class="alert alert-info">
                    Записи удовлетворяющие условиям поиска не найдены
                </div>

                <table ng-if="paginator.$$collection.length > 0" class="table table-striped table-hover x-table-clickable">
                    <thead>
                    <tr>
                        <th>ID</th>
                        <th>Дата</th>
                        <th>Наименование</th>
                        <th>Описание</th>
                        <th>Автор</th>
                        <th>Прогресс</th>
                    </tr>
                    </thead>
                    <tr ng-repeat="i in paginator.getCurrentPage()" ng-click="edit(i)">
                        <td>{{i.id}}</td>
                        <td>{{i.dateOpen}}</td>
                        <td>{{i.title.length < 20 ? i.title : i.title.substring(0, 20) + '...'}}</td>
                        <td>{{i.description.length < 20 ? i.description : i.description.substring(0, 20) + '...'}}</td>
                        <td>{{i.author.firstName}} {{i.author.secondName}}</td>
                        <td>
                            <uib-progressbar animate="true"
                                             value="i.progress"
                                             tooltip-placement="top"
                                             uib-tooltip="{{i.progress}}%"
                                             type="success"></uib-progressbar>
                        </td>
                    </tr>
                </table>

                <div ng-if="paginator.$$collection.length > 0" class="center">
                    <uib-pagination total-items="paginator.$$collection.length"
                                    ng-model="paginator.$$index"
                                    direction-links="false"
                                    items-per-page="paginator.PAGE_SIZE"
                                    class="pagination-sm">
                    </uib-pagination>
                </div>
            </div>
        </div>
    </div>
</div>
